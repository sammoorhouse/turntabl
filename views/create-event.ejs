<!DOCTYPE html>
<html lang="en">

<head>
  <% include partials/head.ejs %>
    <!--CSS styles that ensure your typeform takes up all the available screen space (DO NOT EDIT!)-->
    <style type="text/css">
      html {
        margin: 0;
        height: 100%;
        overflow: hidden;
      }

      iframe {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        border: 0;
      }
    </style>

    <script src="https://js.pusher.com/3.1/pusher.min.js"></script>
</head>

<body id="page-top">

  <% include partials/header.ejs %>
    <script type="text/javascript" src="/bower_components/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/bower_components/moment/min/moment.min.js"></script>
    <script type="text/javascript" src="/bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    <link rel="stylesheet" href="/bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
    <section>
      <div class="container">
        <iframe id="typeform-full" width="100%" height="100%" frameborder="0" src="<%= typeformUrl %>"></iframe>
        <script type="text/javascript" src="https://s3-eu-west-1.amazonaws.com/share.typeform.com/embed.js"></script>
      </div>
    </section>
    <% include partials/footer.ejs %>
      <!--<script>
        $(document).ready(function() {
          $(window).on('message', function(ev) {
            if (ev.originalEvent.data === "form-submit") {
              window.location='/event/<%= eventId %>'
            }
          });
        });
      </script>-->

      <script>
        // Enable pusher logging - don't include this in production
        Pusher.logToConsole = true;

        var pusher = new Pusher('45387f244d056952dda4', {
          encrypted: true
        });

        var channel = pusher.subscribe('<%= eventId %>');
        channel.bind('failure', function(data) {
          console.error('event creation failed')
          window.location = '/eventcreationfailed/<%= eventId %>'
        });
        channel.bind('success', function() {
          console.log('event creation succeeded')
          window.location = '/event/<%= eventId %>'
        })
      </script>

</body>

</html>
